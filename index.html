<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>MAR Consult – Исследования</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icon-192x192.png" />
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #f0f2f5;
      height: 100vh;
      overflow: hidden;
    }
    /* Container for sidebar and main content */
    .app-container {
      display: flex;
      height: 100vh;
      width: 100%;
    }
    /* Sidebar styles */
    .sidenav {
      width: 240px;
      background-color: #ffffff;
      border-right: 1px solid #e0e0e0;
      display: flex;
      flex-direction: column;
    }
    .sidenav .logo {
      font-size: 20px;
      font-weight: bold;
      color: #0077cc;
      padding: 16px 20px;
      border-bottom: 1px solid #e0e0e0;
    }
    .sidenav .menu-item {
      padding: 12px 20px;
      cursor: pointer;
      color: #333333;
      border-bottom: 1px solid #f1f1f1;
      user-select: none;
    }
    .sidenav .menu-item:hover {
      background-color: #f5f9ff;
    }
    .sidenav .menu-item.active {
      background-color: #e6f0ff;
      color: #00579a;
    }
    /* Main area */
    .main {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    .header {
      /* Reduced height to give more space on the page */
      height: 45px;
      background-color: #0077cc;
      color: #ffffff;
      display: flex;
      align-items: center;
      padding: 0 16px;
      flex-shrink: 0;
    }
    .header h1 {
      font-size: 18px;
      font-weight: normal;
      margin: 0;
    }
    .content {
      flex-grow: 1;
      overflow-y: auto;
      padding: 20px;
      background-color: #ffffff;
    }
    /* Page styles */
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
    /* Simple form styling */
    .form-group {
      margin-bottom: 12px;
    }
    .form-group label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
    }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    .button {
      background-color: #0077cc;
      color: #ffffff;
      border: none;
      padding: 10px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    .button:hover {
      background-color: #005fa0;
    }
    /* List styling for studies */
    .study-list {
      list-style: none;
      padding: 0;
    }
    .study-list li {
      padding: 10px 0;
      border-bottom: 1px solid #f1f1f1;
    }
    .study-title {
      font-weight: 600;
      color: #0077cc;
    }
    .study-desc {
      margin-top: 4px;
      color: #555555;
    }

    /* Iframe inside pages */
    .page iframe {
      width: 100%;
      height: 70vh;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    /* Hamburger icon for mobile */
    .hamburger {
      font-size: 24px;
      cursor: pointer;
      margin-right: 12px;
      user-select: none;
      display: none;
    }

    /* Close button for the sidebar on mobile */
    .close-btn {
      font-size: 24px;
      cursor: pointer;
      padding: 16px;
      user-select: none;
      display: none;
      align-self: flex-end;
    }

    /* Mobile specific styles */
    @media (max-width: 768px) {
      /* Sidebar hidden by default on small screens */
      .sidenav {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        z-index: 1000;
        width: 240px;
      }
      .sidenav.open {
        transform: translateX(0);
      }
      .close-btn {
        display: block;
      }
      .hamburger {
        display: block;
      }
      .app-container {
        overflow-x: hidden;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <nav class="sidenav" id="sidenav">
      <div class="logo">MAR Consult</div>
      <!-- Close button for mobile -->
      <span class="close-btn" onclick="toggleNav()">×</span>
      <div class="menu-item active" data-page="home" onclick="navigate(this)">Главная</div>
      <div class="menu-item" data-page="questionnaire" onclick="navigate(this)">Моя анкета</div>
      <div class="menu-item" data-page="profile" onclick="navigate(this)">Заполнить профиль</div>
      <div class="menu-item" data-page="studies" onclick="navigate(this)">Доступные исследования</div>
      <div class="menu-item" data-page="completed" onclick="navigate(this)">Пройденные исследования</div>
      <div class="menu-item" data-page="rewards" onclick="navigate(this)">Награды и бонусы</div>
      <div class="menu-item" data-page="support" onclick="navigate(this)">Поддержка</div>
    </nav>

    <!-- Main content area -->
    <div class="main">
      <div class="header">
        <!-- Hamburger for mobile -->
        <span class="hamburger" onclick="toggleNav()">☰</span>
        <h1 id="page-title">Главная</h1>
      </div>
      <div class="content">
        <!-- Home page -->
        <div id="page-home" class="page active">
          <h2>Добро пожаловать!</h2>
          <p>Это приложение от MAR Consult предназначено для участия в маркетинговых исследованиях. Здесь вы сможете заполнять анкеты, узнавать о новых исследованиях и получать бонусы за активность.</p>
          <p>Выберите пункт меню слева, чтобы продолжить.</p>
        </div>
        <!-- Questionnaire page -->
        <div id="page-questionnaire" class="page">
          <h2>Моя анкета</h2>
          <p>Заполните текущую анкету. После завершения вы сможете вернуться к приложению для участия в других исследованиях.</p>
          <iframe id="survey-frame" src="https://marsurvey.ru/L3322/cgi-bin/ciwweb.pl?hid_studyname=L3322&hid_pagenum=0&hid_test_mode=1" title="Опрос"></iframe>
        </div>
        <!-- Profile page -->
        <div id="page-profile" class="page">
          <h2>Заполнить профиль</h2>
          <p>Расскажите немного о себе, чтобы получать релевантные приглашения на исследования.</p>
          <form onsubmit="saveProfile(event)">
            <div class="form-group">
              <label for="name">Имя</label>
              <input type="text" id="name" required />
            </div>
            <div class="form-group">
              <label for="age">Возраст</label>
              <input type="number" id="age" min="14" max="100" />
            </div>
            <div class="form-group">
              <label for="email">Email</label>
              <input type="email" id="email" />
            </div>
            <div class="form-group">
              <label for="interests">Интересы (через запятую)</label>
              <textarea id="interests" rows="3"></textarea>
            </div>
            <button type="submit" class="button">Сохранить</button>
          </form>
        </div>
        <!-- Studies page -->
        <div id="page-studies" class="page">
          <h2>Доступные исследования</h2>
          <ul class="study-list">
            <li>
              <div class="study-title">Исследование предпочтений</div>
              <div class="study-desc">Краткий опрос о ваших потребительских предпочтениях. Займет не более 5 минут.</div>
            </li>
            <li>
              <div class="study-title">Тестирование упаковки</div>
              <div class="study-desc">Проверка удобства и привлекательности новой упаковки продукта.</div>
            </li>
            <li>
              <div class="study-title">Анализ бренда</div>
              <div class="study-desc">Дайте свою оценку известным брендам на рынке.</div>
            </li>
          </ul>
          <p>Скоро появятся новые исследования! Следите за обновлениями.</p>
        </div>
        <!-- Completed page -->
        <div id="page-completed" class="page">
          <h2>Пройденные исследования</h2>
          <p>Вы еще не проходили исследования. Примите участие в доступных исследованиях, чтобы увидеть этот раздел заполненным!</p>
        </div>
        <!-- Rewards page -->
        <div id="page-rewards" class="page">
          <h2>Награды и бонусы</h2>
          <p>За участие в исследованиях вы будете получать бонусы. Пока у вас нет наград. Участвуйте активнее!</p>
        </div>
        <!-- Support page -->
        <div id="page-support" class="page">
          <h2>Поддержка</h2>
          <p>Если у вас возникли вопросы, напишите нам на <a href="mailto:support@marconsult.ru">support@marconsult.ru</a>. Мы всегда рады помочь.</p>
        </div>
      </div>
    </div>
  </div>
  <script>
    /**
     * Навигация между разделами приложения.
     * При клике на пункт меню показывается соответствующая страница и обновляется заголовок.
     */
    function navigate(elem) {
      const page = elem.getAttribute('data-page');
      // Обновляем активный пункт
      document.querySelectorAll('.sidenav .menu-item').forEach((item) => {
        item.classList.remove('active');
      });
      elem.classList.add('active');
      // Показываем нужную страницу
      document.querySelectorAll('.page').forEach((p) => {
        p.classList.remove('active');
      });
      const activePage = document.getElementById('page-' + page);
      if (activePage) {
        activePage.classList.add('active');
        document.getElementById('page-title').textContent = elem.textContent;
        // Если это анкета, изменить стиль контента для iframe
      }
    }

    /**
     * Сохранение профиля (пока просто показывает алерт).
     */
    function saveProfile(event) {
      event.preventDefault();
      const name = document.getElementById('name').value;
      alert(`Спасибо, ${name || 'участник'}! Ваш профиль сохранен.`);
    }

    /**
     * Переключает отображение бокового меню на мобильных устройствах.
     * Добавляет или убирает класс `.open` у навигации.
     */
    function toggleNav() {
      const nav = document.getElementById('sidenav');
      nav.classList.toggle('open');
    }

    // Регистрация service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js').catch((err) => {
          console.error('ServiceWorker registration failed:', err);
        });
      });
    }
  </script>
</body>
</html>