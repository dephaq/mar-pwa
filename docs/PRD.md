# MAR PWA — Product Requirements Document

## 1. Цели
- Респонденты: быстро устанавливают PWA, заполняют профиль и прескрин, получают персональные приглашения и участвуют в исследованиях.
- Операторы: создают исследования, таргетируют аудиторию, отправляют приглашения и контролируют качество.
- Общее: сокращение времени закрытия квот и стоимости респондента.

## 2. Персоны
### Респондент
- Возраст 18–55, активный пользователь смартфона.
- Мотив: получить вознаграждение за участие в опросах.
- Боли: сложные анкеты, спам, долгое начисление наград.

### Оператор
- Сотрудник исследовательской компании.
- Мотив: быстро набрать целевую аудиторию и контролировать качество данных.
- Боли: ручные рассылки, дубли, «mismatch» прескрина и анкет.

## 3. Ключевые пользовательские флоу
### 3.1 Первый запуск
1. Экран приветствия и ссылка на политику.
2. Подсказка «Добавить на экран Домой».
3. Кнопка «Включить уведомления» (по действию).

### 3.2 Профиль
- Поля: имя, возраст, пол, город, профессия, контакты.
- Автосохранение и индикатор «сохранено».

### 3.3 Прескрин
- Тематические блоки (медицина, авто и т.п.).
- Версионирование и дата обновления.

### 3.4 Лента приглашений
- Карточки с темой, вознаграждением, дедлайном.
- Фильтры и сортировка; CTA «Принять участие».

### 3.5 Анкета
- Встраивание по ссылке (iframe).
- Статусы: начат, завершён, скрин-аут, отказ.

### 3.6 Награды
- Баланс, «в ожидании», «начислено», история транзакций.

### 3.7 Поддержка
- FAQ и форма обращения/чат.

## 4. KPI
- Установки PWA.
- Доля включивших Web Push.
- % заполненных профилей.
- Конверсия приглашение → старт → завершение.
- Время закрытия квот.
- Стоимость респондента.
- Доля «mismatch» прескрин vs анкета.

## 5. Ограничения iOS PWA
- Запрос разрешения на уведомления только по пользовательскому действию и внутри установленного PWA.
- Отсутствие фоновых push при закрытом приложении (до iOS 16.4).
- Ограниченный объём локального хранилища и отсутствие доступа к пушам в браузере.

## 6. Риски и смягчение
| Риск | Смягчение |
|------|-----------|
| Пользователи игнорируют запрос на уведомления | Показывать ценность, повторный запрос через UI |
| Низкая конверсия профиля | Упростить форму, прогресс и автосохранение |
| Дубликаты и «mismatch» | Проверка прескрина в анкете, аудит-лог |
| Отказ iOS от PWA | Обновлять гайды и fallback‑UI |

## 7. Acceptance-критерии MVP
- **Подписка Web Push**: пользователь после установки может подписаться на уведомления; пуш приходит и по клику открывает нужное исследование.
- **Админка CRUD + рассылка**: оператор создаёт, редактирует и удаляет исследования; выбирает сегмент и запускает рассылку приглашений.
- **Экспорт CSV**: оператор выгружает список респондентов или результатов исследования в CSV.

## 8. Аналитические события и метрики
| Событие | Описание |
|---------|----------|
| `app_install` | Первый запуск PWA |
| `profile_completed` | Профиль заполнен |
| `prescreen_updated` | Прескрин сохранён |
| `push_subscribed` | Разрешение на Web Push дано |
| `invite_view` | Открыта карточка исследования |
| `invite_accept` | Нажатие «Принять участие» |
| `survey_start` | Начата анкета |
| `survey_complete` | Завершена анкета |
| `reward_view` | Просмотр экрана наград |
| `support_request` | Отправлено сообщение в поддержку |

### Метрики конверсий
- `push_subscribed / app_install` — enable rate уведомлений.
- `profile_completed / app_install` — заполнение профиля.
- `invite_accept / invite_view` — CTR приглашений.
- `survey_complete / invite_accept` — completion rate.
- `reward_view / survey_complete` — интерес к вознаграждениям.
